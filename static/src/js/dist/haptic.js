/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/js/haptic.js":
/*!**************************!*\
  !*** ./src/js/haptic.js ***!
  \**************************/
/***/ (() => {

eval("\r\n// Create an instance\r\nlet sending_delay = 0.5;\r\nconst delay_value = 0.12;\r\n\r\nlet last_time = 0;\r\nvar intervaltester;\r\nlet current_timer = 0;\r\nlet timeCheckerTerm = 7;\r\nlet pre_resultcheck = 0.0;\r\n\r\nconst beatAmp = 50;\r\nconst beatFreq = 225;\r\n\r\n\r\nlet freq = 200;\r\nlet amp = 30;\r\nlet attack = 0.4;\r\nlet decay = 0.33;\r\nlet sustain = 7;\r\n\r\nlet _IntensityArray = new Int16Array([100, 0]);\r\nlet intensityArrayIndex = 0\r\nlet max_index = 16;\r\nconst Frequency_Field_size = 256;\r\n\r\nconst mappingType = [\"Melody\", \"Beat\"];\r\nlet current_type = 0;\r\nlet envelopTimer = 100;\r\nlet user_num = 16;\r\nlet current_mode = 0;\r\n\r\nlet haptic_recode_activate = false;\r\n\r\nlet freq_slider = document.querySelector('[data-action=\"update_frequency\"]');\r\nfreq_slider.addEventListener('input', event => {\r\n    freq = parseInt(Number(freq_slider.value) * 1.5 + 150);\r\n    console.log(\"Control frequency : \" + freq + \" Hz\");\r\n    //console.log(\"mono_freq : \" + mono_freq);\r\n});\r\n\r\nlet amp_slider = document.querySelector('[data-action=\"update_amplitude\"]');\r\namp_slider.addEventListener('input', event => {\r\n    amp = parseInt(Number(amp_slider.value) * 0.5);\r\n    console.log(\"Control amplitude : \" + amp * 2 + \" A\");\r\n    //console.log(\"mono_amp : \" + mono_amp);\r\n});\r\n\r\nlet attack_slider = document.querySelector('[data-action=\"update_attack\"]');\r\nattack_slider.addEventListener('input', event => {\r\n    attack = Number(attack_slider.value) * 0.009 + 0.1;\r\n    console.log(\"Control attack : \" + attack );\r\n    //console.log(\"mono_freq : \" + mono_freq);\r\n    _IntensityArray = Envelop_Maker(attack, decay, sustain);\r\n});\r\n\r\nlet decay_slider = document.querySelector('[data-action=\"update_decay\"]');\r\ndecay_slider.addEventListener('input', event => {\r\n    decay = Number(decay_slider.value)  * 0.01;\r\n    console.log(\"Control decay : \" + decay );\r\n    _IntensityArray = Envelop_Maker(attack, decay, sustain);\r\n});\r\nlet sustain_slider = document.querySelector('[data-action=\"update_sustain\"]');\r\nsustain_slider.addEventListener('input', event => {\r\n    sustain = parseInt(Number(sustain_slider.value) * 0.1);\r\n    console.log(\"Control sustain\" + sustain );\r\n    _IntensityArray = Envelop_Maker(attack, decay, sustain);\r\n});\r\n\r\nwindow.onbeforeunload = DisconnectAllDevices\r\nfunction DisconnectAllDevices(){\r\n    haptic_devices.clear();\r\n}\r\n\r\nclass HapticArray{              //통신용 블루투스 array 구현 코드\r\n    constructor() {\r\n        this.devices = []\r\n      }\r\n    \r\n    add(hapticdevice){\r\n        this.devices.push(hapticdevice);\r\n    }\r\n    clear(){\r\n        this.devices.forEach(device => {\r\n            device.disconnect(haptic_listener);\r\n        });\r\n        console.log(\"All Device is Disconnected\");\r\n    }\r\n    del(id){\r\n        let index = this.find_index(id)\r\n        if (index != -1){\r\n            this.devices[index].disconnect(haptic_listener)\r\n            this.devices.splice(index, 1);\r\n            console.log(\"device successfully disconneted\" );\r\n        }\r\n    }\r\n    send(data){\r\n        this.devices.forEach(device => {\r\n            device.write(data);\r\n        });\r\n    }\r\n    find_index(id){\r\n        let fin = -1;\r\n        let index = 0;\r\n        this.devices.forEach(device => {\r\n            if (device.device.id == id){\r\n                console.log(\"found the device\", index);\r\n                fin = index\r\n            }\r\n            index = index + 1;\r\n        });\r\n        if (fin == -1){\r\n            console.log(\"there is no device in the list\");\r\n        }\r\n        return fin;\r\n    }\r\n}\r\nlet haptic_devices = new HapticArray();\r\n\r\nclass HapticDevice {\r\n\r\n    constructor() {\r\n      this.device = null;\r\n      this.onDisconnected = this.onDisconnected.bind(this);\r\n    }\r\n    \r\n    async request() {\r\n      let options = {\r\n        \"filters\": [{\r\n          \"namePrefix\": \"Haptic\"\r\n        }],\r\n        \"optionalServices\": [\"6e400001-b5a3-f393-e0a9-e50e24dcca9e\"],\r\n        \"acceptAllDevices\": false\r\n      };\r\n      this.device = await navigator.bluetooth.requestDevice(options);\r\n      if (!this.device) {\r\n        throw \"No device selected\";\r\n      }\r\n      this.device.addEventListener('gattserverdisconnected', this.onDisconnected);\r\n    }\r\n    \r\n    async connect() {\r\n      if (!this.device) {\r\n          Promise.reject('Device is not connected.');\r\n        return 0\r\n      }\r\n      await this.device.gatt.connect();\r\n      return 1\r\n    }\r\n    \r\n    // write(data) {\r\n    //   // RX Characteristic (6E400002-B5A3-F393-E0A9-E50E24DCCA9E)\r\n    //   // Write or Write Without Response\r\n    //   // Write data to the RX Characteristic to send it on to the UART interface.\r\n    //   return this.device.gatt.getPrimaryService(\"6e400001-b5a3-f393-e0a9-e50e24dcca9e\")\r\n    //   .then(service => service.getCharacteristic(\"6e400002-b5a3-f393-e0a9-e50e24dcca9e\"))\r\n    //   .then(characteristic => characteristic.writeValue(data))\r\n    //   .catch(error => {\r\n    //     console.log('Argh! ' + error);\r\n    //     sending_delay = 1.2;\r\n    //   });\r\n    // }\r\n    write(data) {\r\n        // RX Characteristic (6E400002-B5A3-F393-E0A9-E50E24DCCA9E)\r\n        // Write or Write Without Response\r\n        // Write data to the RX Characteristic to send it on to the UART interface.\r\n  \r\n        this.device.gatt.getPrimaryService(\"6e400001-b5a3-f393-e0a9-e50e24dcca9e\")\r\n        .then(service => service.getCharacteristic(\"6e400003-b5a3-f393-e0a9-e50e24dcca9e\"))\r\n        .then(characteristic => {\r\n          //console.log('---!---');\r\n          //console.log(\"Bluetooth Notify Chracteristic Value : \", characteristic.value);\r\n          //console.log(characteristic.oncharacteristicvaluechanged);\r\n          //console.log('---?---');\r\n        });\r\n  \r\n        return this.device.gatt.getPrimaryService(\"6e400001-b5a3-f393-e0a9-e50e24dcca9e\")\r\n        .then(service => service.getCharacteristic(\"6e400002-b5a3-f393-e0a9-e50e24dcca9e\"))\r\n        .then(characteristic => {characteristic.writeValue(data)\r\n          //console.log(\"Bluetooth Write Chracteristic Value : \",characteristic.value);\r\n        })\r\n        .catch(error => {\r\n          console.log('Argh! ' + error);\r\n          SendHapticData(0,0);\r\n        });\r\n    }\r\n    async startNotifications(listener) {\r\n      // TX Characteristic (6E400003-B5A3-F393-E0A9-E50E24DCCA9E)\r\n      // Notify\r\n      // Enable notifications for the TX Characteristic to receive data from the application. The application transmits all data that is received over UART as notifications.\r\n      const service = await this.device.gatt.getPrimaryService(\"6e400001-b5a3-f393-e0a9-e50e24dcca9e\");\r\n      const characteristic = await service.getCharacteristic(\"6e400003-b5a3-f393-e0a9-e50e24dcca9e\");\r\n      await characteristic.startNotifications();\r\n      characteristic.addEventListener('characteristicvaluechanged', listener);\r\n    }\r\n  \r\n    async stopNotifications(listener) {\r\n        const service = await this.device.gatt.getPrimaryService(\"6e400001-b5a3-f393-e0a9-e50e24dcca9e\");\r\n        const characteristic = await service.getCharacteristic(\"6e400003-b5a3-f393-e0a9-e50e24dcca9e\");\r\n        await characteristic.stopNotifications();\r\n        characteristic.removeEventListener('characteristicvaluechanged', listener);\r\n    }\r\n  \r\n    async disconnect(listener) {\r\n      if (!this.device) {\r\n        return Promise.reject('Device is not connected.');\r\n      }\r\n      await this.stopNotifications(listener);\r\n      this.device.gatt.disconnect();\r\n\r\n    }\r\n  \r\n    onDisconnected() {\r\n      console.log('Device is disconnected.');\r\n      console.log('> Name:             ' + this.device.name);\r\n      console.log('> Id:               ' + this.device.id);\r\n      console.log('> Connected:        ' + this.device.gatt.connected);\r\n    }\r\n}\r\nfunction onebyte_to_twobyte_int(high, low){     // 통신 데이터가 byte 단위로 가능하기 때문에 이를 변환해주는 코드들(수정할 필요는 없음)\r\n    let tmp = (((high & 0xff) << 8) | (low & 0xff));\r\n    return tmp;\r\n}\r\nfunction twobyte_int_to_onebyte(origin){    \r\n    let high = ((origin >> 8) & 0xff);\r\n    let low = origin & 0xff;\r\n    return [high, low];\r\n}\r\nfunction onebyte_to_fourbyte_float(origin){\r\n    let buf = new ArrayBuffer(4);\r\n    let view = new DataView(buf);\r\n    origin.forEach(function (b, i) {\r\n        view.setInt8(i, b);\r\n    });\r\n    return view.getFloat32(0);\r\n}\r\nfunction fourbyte_float_to_onebyte(origin){\r\n    let high = ((origin >> 8) & 0xff);\r\n    let low = origin & 0xff;\r\n    return high, low;\r\n}\r\n// function haptic_pattern_gen(){  // haptic code\r\n//     let fftsize = wavesurfer.backend.analyser.frequencyBinCount;\r\n//     let _freq = 1;\r\n//     let _index = 0;\r\n//     let ampArray = new Float32Array(fftsize);\r\n//     let dataArray = [0, 0];\r\n//     wavesurfer.backend.analyser.getFloatTimeDomainData(ampArray);\r\n//     for (let i = 0;i < fftsize; i++){\r\n//         if (ampArray[i] > 0.01) {\r\n//             dataArray.push(ampArray[i]);\r\n//         }\r\n//     }\r\n//     let resultcheck = Math.abs(dataArray.reduce(function add(sum, currvalure){ return sum + Math.max(currvalure,0);}, 0));\r\n    \r\n//     if(current_type == 1){\r\n//         if(resultcheck > pre_resultcheck * 1.4){\r\n//             pre_resultcheck = 0.0 + resultcheck;\r\n//             envelopTimer = 0;\r\n//             return Envelope_Haptic(envelopTimer);\r\n//         }\r\n//         else{\r\n//             pre_resultcheck = 0.0 + resultcheck;\r\n//             envelopTimer += 1;\r\n//             return Envelope_Haptic(envelopTimer);\r\n//         }\r\n//     }\r\n    \r\n//     else{\r\n//         dataArray = new Float32Array(dataArray);\r\n//         _index = dataArray.findIndex(function (item) {return item == Math.max(...ampArray)});\r\n//         console.log(\"index Check\" + _index);\r\n//         _freq  = parseInt(_index/dataArray.length * _HzIndex.length);\r\n//         let _amp = parseInt(resultcheck / Frequency_Field_size * amp * 4) * 2;\r\n//         if (_amp  >= 100){ _amp = 100; }\r\n//         if (_freq == NaN || _freq < 0){ _freq = 0; }\r\n//         return [_HzIndex[_freq], _amp]\r\n//     }\r\n// }\r\n\r\n\r\nfunction Envelop_Maker(attack_parameter, decay_parameter, sustain_parameter){\r\n\r\n    let TMP_intensityArray = new Int16Array(3 + parseInt(sustain_parameter));\r\n    let sustainIntensity = parseInt((50 - 45 * attack_parameter) * beatAmp / 50);\r\n    let decayIndex = parseInt((1 - decay_parameter) * sustain_parameter);\r\n    TMP_intensityArray[0] = beatAmp * 2;\r\n    for(let i = 1; i < decayIndex+1; i++){\r\n        TMP_intensityArray[i] = parseInt((50  - 45 * attack_parameter * i / (decayIndex+1)) * beatAmp / 50) * 2;\r\n    }\r\n    for(let i = decayIndex+1; i<= sustain_parameter; i++){\r\n        TMP_intensityArray[i] = sustainIntensity * 2;\r\n    }\r\n    TMP_intensityArray[1 + parseInt(sustain_parameter)] = 0;\r\n    TMP_intensityArray[2 + parseInt(sustain_parameter)] = 0;\r\n    console.log(TMP_intensityArray)\r\n    return TMP_intensityArray;\r\n}\r\nfunction Envelope_Haptic(index){\r\n    if(index < intensityArrayIndex){\r\n        return [beatFreq, _IntensityArray[index]]\r\n    }\r\n    else{\r\n        return[0, 0]\r\n    }\r\n}\r\n\r\nfunction SimpleMapping(){\r\n    current_timer += timeCheckerTerm;\r\n    if(current_timer >= delay_value * 1000){\r\n        if(intensityArrayIndex >= _IntensityArray.length){\r\n            StopMapping()\r\n        }\r\n        else{\r\n            SendHapticData(freq,_IntensityArray[intensityArrayIndex]);\r\n            intensityArrayIndex += 1;\r\n            current_timer = 0;\r\n        }\r\n    }\r\n}\r\n\r\nfunction StopMapping(){\r\n    SendHapticData(0, 0);\r\n    clearInterval(intervaltester);\r\n}\r\n\r\nfunction Haptic_paly(){\r\n    current_timer = 0;\r\n    intensityArrayIndex = 0;\r\n    clearInterval(intervaltester);\r\n    intervaltester = setInterval(SimpleMapping, timeCheckerTerm);\r\n}\r\n\r\n\r\nfunction SendHapticData(frequency, amplitude){ // mono_amp : max = 0~1 mono_freq : 0 ~ 500hz  //햅틱 정보를 주는 코드\r\n    console.log(\"haptic input\", frequency, amplitude);\r\n    let data_buffer = new ArrayBuffer(19);\r\n    let view = new Int8Array(data_buffer);\r\n    view[0] = 36; // STX 0x24\r\n    view[1] = 2;  // TYPE 0x02\r\n    \r\n    let tmp = twobyte_int_to_onebyte(frequency);\r\n    view[2] = tmp[0];\r\n    view[3] = tmp[1];\r\n    tmp = twobyte_int_to_onebyte(amplitude);\r\n    view[4] = tmp[0];\r\n    view[5] = tmp[1];\r\n    view[17] = 13; // ETX 0x0D\r\n    view[18] = 10; // ETX 0x0A\r\n\r\n    //console.log(view);        // OUTPUT data check log\r\n    //console.log(haptic_devices)\r\n    haptic_devices.send(view);\r\n}\r\nfunction SendCurrentTime(){ // 디바이스에 시계가 추가될 예정이라서 시간 정보를 전달해주는 코드\r\n    console.log(\"Current Time send check\");\r\n    let today = new Date();\r\n    let data_buffer = new ArrayBuffer(19);\r\n    let view = new Int8Array(data_buffer);\r\n\r\n    view[0] = 36; // STX 0x24\r\n    view[1] = 5; // TYPE 0x05\r\n\r\n    view[2] = (today.getFullYear()-2000) & 0xff; // Year 0xEA\r\n    view[3] = (today.getMonth()+1) & 0xff; // Month\r\n    view[4] = today.getDate() & 0xff; // Day\r\n    view[5] = today.getHours() & 0xff; // Hour\r\n    view[6] = today.getMinutes() & 0xff; // Minute\r\n    view[7] = today.getSeconds() & 0xff; // Second\r\n    \r\n    view[17] = 13; // ETX 0x0D\r\n    view[18] = 10; // ETX 0x0A\r\n\r\n    //console.log(view);\r\n    haptic_devices.send(view);\r\n} \r\n\r\nfunction haptic_listener(event){    //Haptic 디바이스가  보내는 정보를 Log로 확인용 코드\r\n    let data_buffer = new ArrayBuffer(19);\r\n    let view = new Uint8Array(data_buffer);\r\n    //console.log('Log Check 3');\r\n    for (let i = 0; i<19;i++){\r\n        view[i] = event.currentTarget.value.getInt8(i);\r\n    }\r\n    console.log(view);\r\n    console.log(data_buffer);\r\n    // 0xF1 : battery info\r\n    // 4byte float\r\n    if (view[1]==-15){\r\n        console.log(\"current battery\" + onebyte_to_fourbyte_float([view[2],view[3],view[4],view[5]])/4.2);\r\n    }\r\n    // 0xF2 : echo [mono_freq] [mono_amp]\r\n    // 2byte, 2byte\r\n    if (view[1]==-14){\r\n        console.log(\"echo data\");\r\n    }\r\n    // 0xF3 : Device info [BLE Connection Interval MIN] [BLE Connection Interval MAX] [Freq MIN] [Freq MAX]\r\n    // 2byte, 2byte, 2byte, 2byte\r\n    if (view[1]==-13){\r\n        console.log(\"Device info\");\r\n        console.log(\"BLE Connection Interval MIN from\" + onebyte_to_twobyte_int(view[2],view[3]));\r\n        console.log(\"BLE Connection Interval MAX from\" + onebyte_to_twobyte_int(0,view[4],view[5]));\r\n        console.log(\"Freq MIN\" + onebyte_to_twobyte_int(view[6],view[7]));\r\n        console.log(\"Freq MAX\" + onebyte_to_twobyte_int(view[8],view[9]));\r\n    }\r\n    // 0xF4 : Device info2 [firmware version] [hardmware version] [MAC Address]\r\n    // 2byte, 2byte, 6byte\r\n    if (view[1]==-12){\r\n        console.log(\"Device info2\");\r\n    }\r\n    // 0xF5 : echo [year] [month] [day] [hour] [min] [sec]\r\n    // 2byte, 2byte, 2byte, 2byte, 2byte, 2byte\r\n    if (view[1]==-11){\r\n        console.log(\"echo time\");\r\n    }\r\n}\r\n\r\n\r\n// 파일 접근 및 웹 코드\r\n// Init & load audio file\r\n// document.addEventListener('DOMContentLoaded', function() {\r\n//     // Init\r\n//     wavesurfer = WaveSurfer.create({\r\n//         container: document.querySelector('#waveform'),\r\n//         waveColor: '#A8DBA8',\r\n//         progressColor: '#3B8686',\r\n//         normalize: true\r\n//     });\r\n//     document.getElementById(\"fileinput\").addEventListener('change', function(e){\r\n//         let file = this.files[0];\r\n//         if (file) {\r\n//             let reader = new FileReader();\r\n//             music_name = file.name.split(\".\")[0];\r\n//             console.log(\"music Name : \" + music_name);\r\n//             if(music_name.substring(0, 4) == 'meta'){\r\n//                 timbreType = music_name.substring(5);\r\n//                 console.log(\"meta Setting : \" + timbreType);\r\n//             }\r\n//             const h3 = document.getElementsByTagName('h5');\r\n//             h3[0].innerText= music_name;\r\n//             reader.onload = function (evt) {\r\n//                 // Create a Blob providing as first argument a typed array with the file buffer\r\n//                 let blob = new window.Blob([new Uint8Array(evt.target.result)]);\r\n//                 // Load the blob into Wavesurfer\r\n//                 wavesurfer.loadBlob(blob);\r\n//             };\r\n\r\n//             reader.onerror = function (evt) {\r\n//                 console.error(\"An error ocurred reading the file: \", evt);\r\n//             };\r\n\r\n//             // Read File as an ArrayBuffer\r\n//             reader.readAsArrayBuffer(file);\r\n//         }\r\n//     }, false);\r\n\r\n//     // Load audio from URL\r\n//     wavesurfer.load(\"./assets/metaSound/\" + music_name +\".mp3\");\r\n\r\n//     // Log errors\r\n//     wavesurfer.on('error', function(msg) {\r\n//         console.log(msg);\r\n//     });\r\n\r\n//     wavesurfer.on('audioprocess', function() {\r\n//         let current_time = wavesurfer.getCurrentTime()\r\n//         let difference_time = current_time - last_time\r\n//         if (difference_time > delay_value || difference_time < 0){\r\n//             let freq_amp = haptic_pattern_gen();\r\n//             SendHapticData(freq_amp[0], freq_amp[1]);\r\n//             if(haptic_recode_activate){\r\n//                 haptic_freq_data.push(freq_amp[0])\r\n//                 haptic_amp_data.push(freq_amp[1])\r\n//             }\r\n//             console.log(\"freq : \" + freq_amp[0] + \"  amp : \" + freq_amp[1]);\r\n//             last_time = current_time;\r\n//         }\r\n//     });\r\n// });\r\n\r\n    // function SetFileList(files){\r\n    //     console.log(\"setting file Number : \" + files.length);\r\n    //     InitializeFilterSetting();\r\n    //     for(let i = 0; i< files.length; i++){\r\n    //         SetFileTimbreToFilter(files[i])\r\n    //     }\r\n    // }\r\n    \r\n    // document\r\n    // .querySelector('[data-action=\"DisconnectHapticDevice\"]')\r\n    // .addEventListener('click', async event => {\r\n    //     SendHapticData(0, 0);\r\n    //     let device = new HapticDevice();\r\n    //     await device.request();\r\n    //     haptic_devices.del(device.device.id);\r\n    // });\r\n\r\n    document\r\n    .querySelector('[data-action=\"SearchHapticDevice\"]')\r\n    .addEventListener('click', async event => {\r\n        let device = new HapticDevice();\r\n        await device.request();\r\n        let flag = await device.connect();\r\n        if (flag){\r\n            await device.startNotifications(haptic_listener);\r\n            let tmp = haptic_devices.find_index(device.device.id)\r\n            if (tmp==-1){\r\n                haptic_devices.add(device);\r\n            }else{\r\n                console.log('the device is already connected')\r\n            }\r\n        }\r\n        console.log('> Name:             ' + device.device.name);\r\n        console.log('> Id:               ' + device.device.id);\r\n        console.log('> Connected:        ' + device.device.gatt.connected);\r\n        setTimeout(function() { SendCurrentTime(); }, 1000);\r\n    });\r\n    \r\n    document\r\n    .querySelector('[data-action=\"Melody\"]')\r\n    .addEventListener('click', event => {\r\n        //console.log(event);\r\n        current_type = 0;\r\n        console.log(\"Melody type\");\r\n        }\r\n    );\r\n\r\n    document\r\n    .querySelector('[data-action=\"Beat\"]')\r\n    .addEventListener('click', event => {\r\n        //console.log(event);\r\n        current_type = 1;\r\n        console.log(\"Beat Type\");\r\n        }\r\n    );\r\n    document\r\n    .querySelector('[data-action=\"playHaptic\"]')\r\n    .addEventListener('click', event => {\r\n        Haptic_paly();\r\n        }\r\n    );\r\n\r\n    // // Bind play/pause button\r\n    // document\r\n    //     .querySelector('[data-action=\"play\"]')\r\n    //     .addEventListener('click', event => {\r\n    //         console.log(event);\r\n    //         if (wavesurfer.isPlaying()){\r\n    //             wavesurfer.playPause();\r\n    //             SendHapticData(0, 0);\r\n    //             intervaltester = setInterval(() => StopMapping(), 0.2);\r\n    //         }else{\r\n    //             if(play_flag){\r\n    //                 play_flag = !play_flag;\r\n    //                 clearInterval(intervaltester);\r\n    //                 SendHapticData(0, 0);\r\n    //                 SendHapticData(0, 0);\r\n    //             }\r\n    //             wavesurfer.playPause();\r\n    //             SendHapticData(0, 0);\r\n    //             SendHapticData(0, 0);\r\n    //         }\r\n    // });\r\n\r\n    // document\r\n    // .querySelector('[data-action=\"play2\"]')\r\n    // .addEventListener('click', event => {\r\n    //     console.log(event);\r\n    //     play_flag = !play_flag;\r\n    //     if(play_flag){\r\n    //         if (wavesurfer.isPlaying()){\r\n    //             wavesurfer.playPause();\r\n    //             SendHapticData(0, 0);}\r\n    //         current_timer = 0;\r\n    //         clearInterval(intervaltester);\r\n    //         intervaltester = setInterval(() => SimpleMapping(), timeCheckerTerm);\r\n    //     }\r\n    //     else{\r\n    //         SendHapticData(0, 0);\r\n    //         clearInterval(intervaltester);\r\n    //     }\r\n    // });\r\n\r\n    // document\r\n    // .querySelector('[data-action=\"CurrentStateChecker\"]')\r\n    // .addEventListener('click', event => {\r\n    //     console.log(event);\r\n    //     play_flag = !play_flag;\r\n    //     if(play_flag){\r\n    //         if (wavesurfer.isPlaying()){\r\n    //             wavesurfer.playPause();\r\n    //             //SendHapticData(0, 0);\r\n    //         }\r\n    //         current_timer = 0;\r\n    //         clearInterval(intervaltester);\r\n    //         intervaltester = setInterval(() => SimpleMapping(), timeCheckerTerm);\r\n    //     }\r\n    //     else{\r\n    //         //SendHapticData(0, 0);\r\n    //         clearInterval(intervaltester);\r\n    //     }\r\n    // });\r\n\r\n    // document\r\n    // .querySelector('[data-action=\"toHaptic\"]')\r\n    // .addEventListener('click', async event => {\r\n    //     document.getElementById(\"fileinput\").click()\r\n    //     // // console.log(wavesurfer.backend.mergedPeaks);\r\n    //     // // vocal, drum, guit, bass, inst\r\n        \r\n    //     // //TODO: fix to sync\r\n    //     // wavesurfer.load('./assets/bass.mp3')\r\n\r\n    //     // console.log(wavesurfer.getDuration());\r\n    //     // console.log(wavesurfer.backend.buffer.sampleRate);\r\n    //     // console.log(wavesurfer.backend.buffer.length);\r\n    //     // console.log(wavesurfer.backend.buffer.numberOfChannels);\r\n\r\n    //     // ch0_data = wavesurfer.backend.buffer.getChannelData(0);\r\n    //     // ch1_data = wavesurfer.backend.buffer.getChannelData(1);\r\n    \r\n    //     // const hz = 100;\r\n    //     // const volume = 1.0;\r\n    //     // const sineWaveArray = new Float32Array(wavesurfer.backend.buffer.length);\r\n    //     // let i;\r\n    //     // let sampleTime;\r\n    \r\n    //     // for (i = 0; i < sineWaveArray.length; i++) {\r\n    //     //     sampleTime = i / wavesurfer.backend.buffer.sampleRate;\r\n    //     //     // sineWaveArray[i] = Math.sin(Math.asin(ch0_data[i])* hz) * volume;\r\n    //     //     // sineWaveArray[i] = Math.sin(Math.asin(ch0_data[i])* Math.PI * 2) * volume;\r\n    //     //     sineWaveArray[i] = Math.sin(sampleTime * Math.PI * 2 * hz) * volume;\r\n    //     // }\r\n        \r\n    //     // ch0_haptic = new Float32Array(wavesurfer.backend.buffer.length);\r\n    //     // ch1_haptic = new Float32Array(wavesurfer.backend.buffer.length);\r\n    \r\n    //     // for (i = 0; i < sineWaveArray.length; i++) {\r\n    //     //     let tmp = 0.5 * (sineWaveArray[i]*Math.abs(ch0_data[i]) + sineWaveArray[i]*Math.abs(ch1_data[i]));\r\n    //     //     ch0_haptic[i] = tmp;\r\n    //     //     ch1_haptic[i] = tmp;\r\n    //     //     // ch0_haptic[i] = sineWaveArray[i];\r\n    //     //     // ch1_haptic[i] = sineWaveArray[i];\r\n    //     // }\r\n    \r\n    //     // console.log(ch1_haptic)\r\n    //     // wavesurfer.backend.buffer.copyToChannel(ch0_haptic, 0);\r\n    //     // wavesurfer.backend.buffer.copyToChannel(ch1_haptic, 1);\r\n        \r\n    //     // wavesurfer.loadDecodedBuffer(wavesurfer.backend.buffer);\r\n    \r\n    //     // // console.log(wavesurfer.backend.data);\r\n    //     // // wavesurfer.load(osc)\r\n    // });\r\n\r\n    // // Test커트용코드\r\n    // (function() {\r\n    //     const progressDiv = document.querySelector('#progress-bar');\r\n    //     const progressBar = progressDiv.querySelector('.progress-bar');\r\n\r\n    //     let showProgress = function(percent) {\r\n    //         progressDiv.style.display = 'block';\r\n    //         progressBar.style.width = percent + '%';\r\n    //     };\r\n\r\n    //     let hideProgress = function() {\r\n    //         progressDiv.style.display = 'none';\r\n    //     };\r\n\r\n    //     wavesurfer.on('loading', showProgress);\r\n    //     wavesurfer.on('ready', hideProgress);\r\n    //     wavesurfer.on('destroy', hideProgress);\r\n    //     wavesurfer.on('error', hideProgress);\r\n    // })();\r\n    \r\n\n\n//# sourceURL=webpack://Synthesizer/./src/js/haptic.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = {};
/******/ 	__webpack_modules__["./src/js/haptic.js"]();
/******/ 	
/******/ })()
;